<project name="ano-site-junit" default="all" basedir=".">

    <property name="output.dir" value="${basedir}/build"/>
    <property name="classes.dir" value="${output.dir}/classes"/>
    <property name="test-results" value="${basedir}/test-results"/>
    <property name="test-dir" value="${test-results}/bin"/>
    <property name="lib" value="${basedir}/lib"/>

    <target name="all" depends="compile,run"/>

    <target name="compile">
        <ant antfile="build.xml" target="generate"/>
        <ant antfile="build.xml" target="compile"/>
    </target>

    <target name="run">
        <mkdir dir="${basedir}/test-results"/>
        <junit haltonfailure="no" printsummary="on">
            <classpath>
                <pathelement path="${lib}/junit-4.4.jar"/>
                <fileset dir="${lib}">
                    <include name="*.jar"/>
                </fileset>

                <pathelement location="${classes.dir}"/>
            </classpath>
            <batchtest todir="${test-results}">
                <fileset dir="${classes.dir}">
                    <include name="**/junit/**/*Test.class"/>
                </fileset>
            </batchtest>
            <formatter type="brief" usefile="false"/>
            <formatter type="xml"/>
        </junit>
    </target>

    <target name="clean">
         <ant antfile="build.xml" target="clean"/>
         <delete dir="${basedir}/test-results"/>
    </target>
</project>